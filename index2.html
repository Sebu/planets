<html>
<head> 
<title>webgl test2</title> 
<meta http-equiv="content-type" content="text/html; charset=ISO-8859-1"> 

<script src="http://cdn.jquerytools.org/1.2.5/full/jquery.tools.min.js"></script> 
<script type="text/javascript" src="scenejs/lib/scenejs.js"></script> 
<script type="text/javascript" src="scenejs/lib/scenejs-query-node-pos.js"></script> 
<script type="application/javascript" src="stardateviz.js"></script>

<style>
html, body {
  width: 100%;
  height: 100%;
  background-color: rgb(25,25,25);
  font-family: sans-serif;
}
.slider {
	width:94px;
	height:5px;
	cursor:pointer;
	position: relative;
	float:left;
}

/* drag handle */
.handle {
	height:13px;
	position:absolute;
	top:-5px;
	width:12px;
	cursor:move;
}

.fpsContainer {
  position: absolute;
  top: 10px;
  left: 10px;
  z-index: 2;
  color: gray;
  background-color: rgba(150,150,150,0.5);
  border-radius: 10px;
  padding: 10px;
}
.fps {
  color: white;
}
#uiContainer {
  z-index: 2;
  position: absolute;
  top: 10px;
  right: 20px;
  width: 250px;
  background: rgba(150,150,150,0.5);
  color: white;
  font-size: xx-small;
  border-radius: 10px;
  padding: 10px;
}
#ui {
}
.clickable {
  cursor: pointer;
}
#viewContainer {
	text-align:center;
  margin: auto;
}
</style>

</head>

<body>
<body>
<div class="fpsContainer">
  <div id="topUI">
  <div><span class="clickable" id="setSetting7">Change View</span>
  <span style="float: right" class="clickable" id="setSetting8">*</span></div>
  <div class="clickable" id="options">Options...
  <div id="optionsContainer">
 
  </div>
  </div>
  </div>
</div>
<div id="uiContainer">
<div id="ui"> <input type="range"></div>
</div>
<div id="viewContainer">

<canvas id="glCanvas" width="1024" height="768" >
  <p>This example requires a browser that supports the
     <a href="http://www.w3.org/html/wg/html5/">HTML5</a> 
     &lt;canvas&gt; feature.</p> 
</canvas>
</div>

</body>
<script>
$(":range").rangeinput();
</script>
  
<script type="text/javascript"> 

var scene = SceneJS.scene(
  { id: "theScene", canvasId: "glCanvas" },
  SceneJS.renderer({             /* Specifies which buffers are cleared for each frame
             */
            clear: {
                depth : true,
                color : true,
                stencil: false
            },

            /* Specify clear values for the colour buffers
             */
            clearColor: {
                r: 0.1,
                g : 0.1,
                b : 0.1
            },

 

           /* Specify the clear value for the depth buffer
             */
            clearDepth: 1.0,

            /* Set the width of rasterised lines
             */
            lineWidth: 1,
            /*----------------------------------------
             Culling
             -----------------------------------------*/

            /* Enable/disable face culling
             */
            enableCullFace: true,

            /* Specify facet culling mode, accepted values are: front, back, front_and_back
             */
            cullFace: "back",

            /* Specify front/back-facing mode. Accepted values are cw or ccw
             */
            frontFace: "cw" },

  SceneJS.lookAt({
    eye : { x: 0.0, y: 0.0, z: -15 }, look : { z:1.0 }, up: { y: 1.0 } 
    },

    SceneJS.camera( {
      optics: { type: "perspective", fovy : 90.0, aspect : 1.33, near : 0.10, far : 300.0}
      },


			 light = new SceneJS.Light({
             mode: "point",
             pos: { x: 0.0, y: 0.0, z: 0.0 }, // Position
             color: { r: 1.0, g: 1.0, b: 1.0 },
             diffuse: true,   // Contribute to diffuse lighting
             specular: true,  // Contribute to specular lighting
             constantAttenuation: 1.0,
             quadraticAttenuation: 0.0,
             linearAttenuation: 0.0             

        }),

       SceneJS.material({
              baseColor:      { r: 0.2, g: 0.9, b: 0.2 },
              specularColor:  { r: 0.9, g: 0.9, b: 0.2 },
              emit: 0.0, specular: 0.0, shine: 6.0
           },
				new SceneJS.Rotate({id: "pitch", angle: 0.0, x: 1.0},
				new SceneJS.Rotate({id: "yaw", angle: 0.0, y: 1.0},
				new SceneJS.Sky(),
				new SceneJS.Planet({tex: "textures/earthmap1k.jpg"} ), 
SceneJS.material({
	              baseColor:      { r: .5 , g: 0.7, b: 0.3 },
  	            specularColor:  { r: 0.0, g: 0.0, b: 0.0 },
    	          emit: 0.2, specular: 0.0, shine: 1.0, opacity: 1.0
           },
        	

				 system = new SceneJS.Spherical({scale: 9, angle: 90.0},
						system2 =	new SceneJS.Spherical({ scale: 9, angle: 24.0},
										system3 = new SceneJS.Spherical({ scale: 9, angle: 90.0},
											new SceneJS.Translate({x:0.0, y:9.0, z:0.0},
			 								 new SceneJS.Scale( { id: "sun", x:0.2, y:0.2, z:0.2 }, 
										    new SceneJS.Planet({ emit: 0.2, tex: "textures/sunmap.jpg"} ))),
											system4 = new SceneJS.Spherical({ scale: 9, angle: -90.0},
										    new SceneJS.Translate({x:0.0, y:9.0, z:0.0},
			 										new SceneJS.Scale( {x:0.2, y:0.2, z:0.2 }, 
														new SceneJS.Planet({tex: "textures/mercurymap.jpg"} )
			 										
				        					)
											 )
										 ) 
									 )
								)
						))
						
		  ))
		  )
		)
	)
));

SceneJS.bind("error", function(e) {
   if (e.exception.message) {
       alert("Error: " + e.exception.message);
   } else {
       alert("Error: " + e.exception);
   }
});

var angle = 0.0;
window.render = function() {
		angle += 0.5;
		system.setRotate(angle);
	  system2.setRotate(-angle*2.0);
	  system3.setRotate(angle/2.0);
	  system4.setRotate(-angle/2.0);

		fixLight(light,"sun");

    scene.render(); 
    
};

SceneJS.withNode("sun").bind("picked",
        function(event) {
            alert("Picked: 'right-green-sphere'");
        });

var yaw = 0;
var pitch = 0;
var lastX;
var lastY;
var dragging = false;

function mouseDown(event) {
    lastX = event.clientX;
    lastY = event.clientY;
    dragging = true;
//    SceneJS.withNode("theScene").pick(event.offsetX, event.offsetY);
}

function mouseUp() {
    dragging = false;
}

/* On a mouse drag, we'll re-render the scene, passing in
 * incremented angles in each time.
 */
function mouseMove(event) {
    if (dragging) {
        yaw += (event.clientX - lastX) * 0.5;
        pitch += (event.clientY - lastY) * -0.5;

        SceneJS.withNode("yaw").set("angle", yaw);
        SceneJS.withNode("pitch").set("angle", pitch);

        SceneJS.withNode("theScene").render();

        lastX = event.clientX;
        lastY = event.clientY;
    }
}

var canvas = document.getElementById("glCanvas");
canvas.addEventListener('mousedown', mouseDown, true);
canvas.addEventListener('mousemove', mouseMove, true);
canvas.addEventListener('mouseup', mouseUp, true);

var pInterval = setInterval("window.render()", 30);  
 
</script>



 
</body>
</html>
